<div class="modal-dialog modal-notify modal-info export-order modal-lg"  role="document" >
  <div class="loader-main" *ngIf="isLoaderAdmin"><img src="../../../assets/loading-spinner.gif" /></div>

  <div class="modal-content ">
    <div class="modal-header modal-bcolor-primary px-0 pt-0">
      <p class="heading lead  work-content">Add new order</p>
      <button type="button" class="close close-btn" data-dismiss="modal" aria-label="Close" (click)="onNoClick()">
        <span aria-hidden="true" class="white-text">&times;</span>
      </button>
    </div>
    <div class="modal-body pb-0 px-0"> 
      <div class="new-order-table" *ngIf="addOrderFormType === 'selectTicket'">
        <div class="code-tab">
            <div class="service-listing">
                <div class="main-table-content main-cust-table-content">
                    <div class="">
                        <div class="heads main-heading-content drageble" fxLayout="row">
                          <div class="th-data" fxFlex="10"></div> 
                          <div class="th-data" fxFlex="30">TICKET TYPE</div>                           
                          <div class="th-data" fxFlex="20">PRICE</div>
                          <div class="th-data" fxFlex="20">Fee</div>
                          <div class="th-data" fxFlex="20">QUANTITY</div>
                        </div>
                        <div class="content" class="drageble-list" *ngFor="let eventTicket of eventTicket;let i=index">
                          <div class="drageble-box" fxLayout="row">
                              <div class="tb-data" fxFlex="10">
                                <!-- <mat-checkbox  (change)="fnBookTicket($event,i)" ></mat-checkbox> -->
                              </div>   
                              <div class="tb-data" fxFlex="30">{{eventTicket.ticket_name}} </div>                               
                              <div class="tb-data" fxFlex="20"><input type="hidden" class="form-control" >{{ eventTicket.prize | currency:currencyCode:'symbol' }}</div>
                              <div class="th-data" fxFlex="20">{{ eventTicket.booking_fee | currency:currencyCode:'symbol' }}</div>
                              <div class="tb-data" fxFlex="20">
                                <input type="number"  class="form-control" value="{{eventTicket.qty}}" (change)="fnAddQty(i,$event.target.value);" >      
                              </div>
                          </div>
                      </div>
                      <div class="content" class="drageble-list">
                        <div class="drageble-box" fxLayout="row">
                            <div class="tb-data fw-600" fxFlex="50">Subtotal</div>
                            <div class="tb-data" fxFlex="30"></div>
                            <div class="tb-data fw-600" fxFlex="20" >{{ subTotal | currency:currencyCode:'symbol' }}</div>
                        </div>
                    </div>
                    </div>
                </div>
            </div>
            <div class="example-button-row ml-auto mt-4">
              <button mat-raised-button class="comm-btn d-flex ml-auto"  [disabled]="is_added_at_least_item" (click)="fnTicketCheckout('CheckoutForm')">Next</button>
              </div>
        </div>
      </div>   
    </div>
  
      <div  class="with-validation checkout-form" *ngIf="addOrderFormType === 'CheckoutForm'">
        <h4 class="main-head">Checkout</h4>
        <div class="itemlist-table">
          <div class="service-listing">
            <div class="main-table-content main-cust-table-content">
                <div class="">
                  <div class="heads main-heading-content drageble" fxLayout="row">
                      <div class="th-data" fxFlex="30">Item</div>
                      <div class="th-data" fxFlex="20">Price</div>
                      <div class="th-data" fxFlex="15">Fee</div>
                      <div class="th-data" fxFlex="15">Quantity</div>
                      <div class="th-data" fxFlex="20" class="align-end">Subtotal</div>
                  </div>
                  <div class="content" class="drageble-list">
                      <div class="drageble-box fw-600" fxLayout="row"  *ngFor="let eventTicket of eventTicket"  >
                          <div *ngIf="eventTicket.id_added" class="tb-data order-item fw-100" fxFlex="30" >{{eventTicket.ticket_name}}</div>
                          <div *ngIf="eventTicket.id_added" class="tb-data" fxFlex="20">{{ eventTicket.prize | currency:currencyCode:'symbol' }}</div>
                          <div *ngIf="eventTicket.id_added" class="tb-data" fxFlex="15">{{ eventTicket.booking_fee | currency:currencyCode:'symbol' }}</div>
                          <div *ngIf="eventTicket.id_added" class="tb-data" fxFlex="15">{{eventTicket.qty}} </div>
                          <div *ngIf="eventTicket.id_added" class="tb-data align-end" fxFlex="20">{{ fnSum(eventTicket.qty,eventTicket.prize,eventTicket.booking_fee) | currency:currencyCode:'symbol' }}</div>                        
                      </div>
                  </div>     
                  <div class="content" class="drageble-list">
                    <div class="drageble-box fw-600"  fxLayout="row">
                        <div class="tb-data fs-15 fw-600" fxFlex="35">Order Total</div>
                        <div class="tb-data" fxFlex="20"></div>
                        <div class="tb-data" fxFlex="15"></div>
                        <div class="tb-data" fxFlex="15"></div>
                        <div class="tb-data align-end fs-15" fxFlex="20">{{ subTotal-discount | currency:currencyCode:'symbol' }}</div>                        
                    </div>
                </div>  
                <div class="content" class="drageble-list">
                  <div class="drageble-box fw-600"  fxLayout="row">
                      <div class="tb-data order-item fw-100" fxFlex="20">
                      </div>       
                      <div class="tb-data" fxFlex="25"></div>
                      <div class="b-data align-end fs-15" fxFlex="15"></div>       
                  </div>
                </div>             
              </div>
            </div>
          </div>
        </div>
        <div class="mt-2">
          <a href="javascript:;" (click)="fnTicketCheckout('selectTicket')"  class="link p-0">Change your order</a>
        </div>
        <div class="mt-16">
          <div class="form-group">
            <label for="" class="main-head fw-600">Do you have a promo code?</label>
            <div class="row">
              <div class="col-10 pr-1">
                  <input type="text" class="form-control" [(ngModel)]="promo_code" [disabled]="coupon_code!='' || voucher_code!=''"  >
                  <!-- <span class="error-wrap" *ngIf="bookTickets.get('promo_code').dirty || bookTickets.get('promo_code').touched">
                    <small *ngIf="bookTickets.get('promo_code').hasError('required')" class="error text-left">Promo Code is required.</small>
                    <small *ngIf="bookTickets.get('promo_code').hasError('maxlength') || bookTickets.get('promo_code').hasError('minlength')" class="error">Promo Code Should be of 6 digits.</small>
                  </span> -->
              </div>
              <div class="col-2 pl-1">
                <button mat-raised-button class="ticket-btn comm-btn" (click)="fnAddDiscount()">Apply</button>
              </div>
            </div>
          </div>

          <div class="checkout mt-2">
            <label class="main-head mb-3 fw-600">Please complete the form below to checkout</label>
           
            <form *ngIf="eventForm && eventForm.length  > 0" [formGroup]="bookTickets">

              <div class="form-group">
                <label>{{eventForm[0].label}} <span class="text-danger">*</span> </label>
                <input type="text" class="form-control" id="" placeholder="" formControlName ="name">
                <span class="error-wrap" *ngIf="bookTickets.get('name').dirty || bookTickets.get('name').touched">
                  <small *ngIf="bookTickets.get('name').hasError('required')" class="error text-left">full Name is required.</small>
                </span>
              </div>

              <div class="form-group">
                <label>{{eventForm[1].label}} <span class="text-danger">*</span> </label>
                <input matInput type="text" class="form-control" formControlName="email"  placeholder="">
                <span class="error-wrap" *ngIf="bookTickets.get('email').dirty || bookTickets.get('email').touched">
                  <small *ngIf="bookTickets.get('email').hasError('required')" class="error text-left">Email is required.</small>
                  <small *ngIf="bookTickets.get('email').hasError('pattern')" class="error">Enter valid email.</small>
                  <small *ngIf="bookTickets.get('email').hasError('isEmailUnique')" class="error">Email is already exists.</small>
                </span>
              </div>

              <div class="form-group">
                <label> {{eventForm[2].label}} <span class="text-danger">*</span> </label>
                <input matInput type="text" class="form-control" formControlName="address" placeholder="">
                <span class="error-wrap" *ngIf="bookTickets.get('address').dirty || bookTickets.get('address').touched">
                    <small *ngIf="bookTickets.get('address').hasError('required')" class="error text-left">Address is required.</small>
                </span>
              </div>

              <div class="form-group">
                <label>{{eventForm[3].label}} <span class="text-danger">*</span> </label>
                <input matInput type="text" formControlName="phone" class="form-control" placeholder="">
                <span class="error-wrap" *ngIf="bookTickets.get('phone').dirty || bookTickets.get('phone').touched">
                  <small *ngIf="bookTickets.get('phone').hasError('required')" class="error text-left">Phone Number is required.</small>
                  <small *ngIf="bookTickets.get('phone').hasError('pattern') || bookTickets.get('phone').hasError('pattern') && (bookTickets.get('phone').hasError('maxlength') || bookTickets.get('phone').hasError('minlength'))" class="error">Phone Number Should in numbers</small>
                  <small *ngIf="bookTickets.get('phone').hasError('maxlength') || bookTickets.get('phone').hasError('minlength')" class="error">Phone Number Should Minimum 6 and Maximum 15 digits.</small>
                </span>
              </div>
            </form>

            <div *ngFor="let val of eventSpecificForm;let i=index" class="form-group">
              
              <div class="" *ngIf="val.type=='text'">
                  <label> {{val.label}} <span class="text-danger"> {{ val.required ? '*' : ''}} </span> </label>
                  <input matInput type="text" class="form-control"  [(ngModel)]="val.value" placeholder="">
                  <span class="error-wrap error" *ngIf="val.required && val.value=='' && is_submit">
                      {{val.label}} is required.
                  </span>
              </div>

              <div class="" *ngIf="val.type=='dropdown'">
                  <label> {{val.label}} <span class="text-danger"> {{ val.required ? '*' : ''}} </span> </label>
                  <select [(ngModel)]="val.value" class="form-control">
                      <option *ngFor="let dropVal of optionsArr(val.options);let optionI=index">{{dropVal}}</option>
                  </select>
                  <span class="error-wrap error" *ngIf="val.required && val.value=='' && is_submit">
                      <small> {{val.label}} is required.</small>
                  </span>
              </div>

              <div class="" *ngIf="val.type=='radio'">
                  <label> {{val.label}} <span class="text-danger"> {{ val.required ? '*' : ''}} </span> </label>
                  <div *ngFor="let radioVal of optionsArr(val.options);let optionCheck=index">
                      <input  type="radio"   value="{{radioVal}}" [(ngModel)]="val.value" > 
                      {{radioVal}}
                  </div>
                  <span class="error-wrap error" *ngIf="val.required && val.value=='' && is_submit">
                    <small> {{val.label}} is required.</small>
                  </span>
              </div>

              <div class="" *ngIf="val.type=='checkbox'">
                  <label> {{val.label}} <span class="text-danger"> {{ val.required ? '*' : ''}} </span> </label>
                  <div *ngFor="let checkboxVal of val.selector;let optionCheck=index">
                      <input  type="checkbox"    value="{{checkboxVal.value}}" [(ngModel)]="checkboxVal.is_check" > 
                      {{checkboxVal.value}}
                  </div>
                  <span class="error-wrap error" *ngIf="val.required && val.value=='' && is_submit">
                    <small> {{val.label}} is required.</small>
                  </span>
              </div>

              <div class="" *ngIf="val.type=='marketing'">
                <label> {{val.label}} <span class="text-danger"> {{ val.required ? ' * ' : ''}} </span> </label> &nbsp;&nbsp;&nbsp;
                <div>
                    <input  type="checkbox" class=""  [(ngModel)]="val.value" >
                </div>
                  <span class="error-wrap error" *ngIf="val.required && val.value=='' && is_submit">
                    <small> {{val.label}} is required.</small>
                  </span>
              </div>

              <div class="" *ngIf="val.type=='terms'">
                  <label> Terms & Conditions  <span class="text-danger"> {{ val.required ? ' * ' : ''}} </span> </label> &nbsp;&nbsp;&nbsp;
                  <div>
                      <input  type="checkbox" class=""  [(ngModel)]="val.value" >
                      {{val.label}}
                  </div>
                  <span class="error-wrap error" *ngIf="val.required && val.value=='' && is_submit">
                    <small> {{val.label}} is required.</small>
                  </span>
              </div>

            </div>

          </div>

              <!-- <div class="form-group">
                <label for="">Mobile Phone Number <span><i class="fa fa-asterisk"></i></span> </label>
                <input type="text" class="form-control" id=""  placeholder="" formControlName = "phone">
                <span class="error-wrap" *ngIf="bookTickets.get('phone').dirty || bookTickets.get('phone').touched"><small *ngIf="bookTickets.get('phone').hasError('required')" class="error text-left">Phone Number is required.</small>
                <small *ngIf="bookTickets.get('phone').hasError('pattern') || bookTickets.get('phone').hasError('pattern') && (bookTickets.get('phone').hasError('maxlength') || bookTickets.get('phone').hasError('minlength'))" class="error">Phone Number Should Minimum 6 and Maximum 15 digits</small>
                <small *ngIf="bookTickets.get('phone').hasError('maxlength') || bookTickets.get('phone').hasError('minlength')" class="error">Phone Number Should Minimum 6 and Maximum 15 digits.</small>
              </span>
              </div>

              <div class="form-group">
                <label for="">Address Line 1 <span><i class="fa fa-asterisk" ></i></span> </label>
                <input type="text" class="form-control" id="" placeholder="" formControlName = "address">
                <span class="error-wrap" *ngIf="bookTickets.get('address').dirty || bookTickets.get('address').touched"><small *ngIf="bookTickets.get('address').hasError('required')" class="error text-left">Address is required.</small></span>
              </div>

              <div class="form-group">
                <label for="">Address Line 2 </label>
                <input type="text" class="form-control" id=""  placeholder="" formControlName = "address_2">
                <span class="error-wrap" *ngIf="bookTickets.get('address_2').dirty || bookTickets.get('address_2').touched"><small *ngIf="bookTickets.get('address_2').hasError('required')" class="error text-left">Address is required.</small></span>
              </div>

              <div class="form-group">
                <label for="">Address Line 3 </label>
                <input type="text" class="form-control" id=""  placeholder="" formControlName ="address_3">
                <span class="error-wrap" *ngIf="bookTickets.get('address_3').dirty || bookTickets.get('address_3').touched"><small *ngIf="bookTickets.get('address_3').hasError('required')" class="error text-left">Address is required.</small></span>
              </div>

              <div class="form-group">
                <label for="">Postcode <span><i class="fa fa-asterisk" ></i></span> </label>
                <input type="text" class="form-control" id=""  placeholder="" formControlName ="postcode">
                <span class="error-wrap" *ngIf="bookTickets.get('postcode').dirty || bookTickets.get('postcode').touched"><small *ngIf="bookTickets.get('postcode').hasError('required')" class="error text-left">Postcode is required.</small>
                  <small *ngIf="bookTickets.get('postcode').hasError('pattern') || bookTickets.get('postcode').hasError('pattern') && ( bookTickets.get('postcode').hasError('maxlength') || bookTickets.get('postcode').hasError('minlength') )" class="error">Postcode Should Minimum 5 and Maximum 6 digits</small>
                </span>
              </div> -->
           

          <!-- <div class="general-admission">
            <label class="main-head">General Admission 1</label>
              <div class="form-group">
                <label for="">Attendee name <span><i class="fa fa-asterisk" aria-hidden="true"></i></span> </label>
                <input type="text" class="form-control" id="" aria-describedby="emailHelp" placeholder="" formControlName ="attendee_name">
                <span class="error-wrap" *ngIf="bookTickets.get('attendee_name').dirty || bookTickets.get('attendee_name').touched"><small *ngIf="bookTickets.get('attendee_name').hasError('required')" class="error text-left">Attendee Name is required.</small></span>
              </div>
          </div> -->
        </div>
        <button mat-raised-button class="comm-btn d-flex ml-auto" (click)="fnTicketCheckout('book-order')">Next</button>
      </div>


    <!-- <div *ngIf="addOrderFormType === 'book-order'">
      <div class="book-order">
        <div class="row">
          <div class="col-md-8">
            <button mat-raised-button class="comm-btn mr-2" (click)="resendOrder()">Resend Ticket</button>
            <button mat-raised-button class="comg-btn mr-2"  (click)="editOrder()">Edit Order</button>
            <button mat-raised-button class="comg-btn mr-2" (click)="cancelOrder()">Cancel Order</button>
          </div>        
          <div class="print-order col-md-4 px-0">
            <a target="_blank" class=""><span class=""><mat-icon aria-hidden="false" aria-label="" class="link mr-2">print</mat-icon></span>Print order confirmation</a>
          </div>
        </div>
      </div>
      <div class="order-details">
        <div class="order-head row">
          <p>Order details</p>
          <a target="_blank" (click)="fnDownloadInvoice(orderDetail.unique_code)" class="dwnld-invoice">Download invoice</a>
        </div>
        <div class="order-desc">
          <div class="row">
            <label class="col-md-4">Date / time of order:</label>
            <p class="col-md-8">{{orderDate}}</p>
          </div>
          <div  class="row">
            <label class="col-md-4">Payment method:</label>
            <p class="col-md-8">OPERATOR</p>
          </div>
          <div  class="row">
            <label class="col-md-4">Transaction ID:</label>
            <p class="col-md-8">-</p>
          </div>
        </div>
        <div class="order-table">
          <div class="service-listing">
            <div class="main-table-content main-cust-table-content">
                <div class="">
                    <div class="heads main-heading-content drageble" fxLayout="row">
                      <div class="th-data" fxFlex="50">Item</div>
                      <div class="th-data" fxFlex="30">PRICE</div>
                      <div class="th-data" fxFlex="20">Fee</div>
                      <div class="th-data" fxFlex="30">Qty</div>
                      <div class="th-data" fxFlex="20">Subtotal</div>
                    </div>
                    <div class="content" class="drageble-list">
                      <div class="drageble-box" fxLayout="row">
                          <div class="tb-data" fxFlex="50">{{eventDate}}: {{orderDetail.events.event_title}}</div>
                          <div class="tb-data" fxFlex="30"></div>
                          <div class="tb-data" fxFlex="20"></div>
                          <div class="tb-data" fxFlex="30"></div>
                          <div class="tb-data" fxFlex="20"></div>
                      </div>
                  </div>
                  <div class="content" class="drageble-list"  *ngFor="let eventTicket of orderDetail.order_item">
                    <div class="drageble-box fw-600" fxLayout="row">
                        <div class="tb-data order-item fw-100" fxFlex="50" >{{eventTicket.ticket.ticket_name}}</div>
                        <div class="tb-data" fxFlex="30">{{eventTicket.ticket.prize | currency : currencyCode}}</div>
                        <div class="tb-data" fxFlex="20">{{0 | currency : currencyCode}}</div>
                        <div class="tb-data" fxFlex="30">1</div>
                        <div class="tb-data align-end" fxFlex="30">{{eventTicket.sub_total | currency : currencyCode}}</div>                        
                    </div>
                </div>    
                <div class="content" class="drageble-list">
                  <div class="drageble-box" fxLayout="row">
                      <div class="tb-data fw-600" fxFlex="50">Grand Total</div>
                      <div class="tb-data" fxFlex="30"></div>
                      <div class="tb-data" fxFlex="20"></div>
                      <div class="tb-data" fxFlex="30"></div>
                      <div class="tb-data fw-600" fxFlex="20">{{orderDetail.grand_total | currency : currencyCode}}</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="buyer-details">
        <div class="buyer-head row">
          <p>Buyer details</p>
          <a href="#" target="_blank" class="dwnld-invoice"></a>
        </div>
        <div class="buyer-desc">
          <div class="row">
            <label class="col-md-4">Name:</label>
            <p class="col-md-8">{{orderDetail.customer ? orderDetail.customer.name : '-'}}</p>
          </div>
          <div  class="row">
            <label class="col-md-4">E-mail:</label>
            <a href="#"  class="col-md-8" target="_blank">{{orderDetail.customer ? orderDetail.customer.email : '-'}}</a>
          </div>
          <div  class="row">
            <label class="col-md-4">Transaction ID:</label>
            <p class="col-md-8">-</p>
          </div>
          <div  class="row">
            <label class="col-md-4">Address:</label>
            <p class="col-md-8">{{orderDetail.customer ? orderDetail.customer.address : '-'}}</p>
          </div>
        </div>
      </div>
      
      <div class="ticket-details" *ngFor="let val of order_item_data;let i=index">
        <div class="ticket-head row"  >
          <p>Ticket details</p>
          <a target="_blank" class="dwnld-invoice" (click)="fnDownloadTicket(val.unique_code)">Download ticket as PDF</a>
        </div>
        <div class="ticket-desc">
          <div class="row">
            <label class="col-md-4">Ticket code:</label>
            <a href="#" class="col-md-8" target="_blank">
              {{val.ticket ? val.ticket.unique_code : '-'}}
            </a>
          </div>
          <div  class="row">
            <label class="col-md-4">Name:</label>
            <p class="col-md-8">{{'-'}}</p>
          </div>
          <div  class="row">
            <label class="col-md-4">Status:</label>
            <p class="col-md-8">{{ val.order_status== 'P' ? 'Pending' : val.order_status== 'CO' ? 'complete' : val.order_status== 'C' ? 'Cancel' : 'Void'}}</p>
          </div>
          <div  class="row">
            <label class="col-md-4">Ticket type:</label>
            <p class="col-md-8">
              {{val.ticket ? val.ticket.ticket_name : '-'}}
            </p>
          </div>
        </div>
      </div>
    </div> -->

  </div>
</div>
